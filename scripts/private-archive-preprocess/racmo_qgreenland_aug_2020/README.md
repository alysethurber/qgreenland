# About

https://nsidc.slack.com/archives/CRB96FG68/p1608311238016100

The data was delivered to us in two phases: Once in August 2020 and with fixes
in Janurary 2021. In August, the data was delivered via Dropbox upload. In
January, the data was provided via ramadda.science.uu.nl with username/password
access. See email in qgreenland.info@gmail.com mailbox from 2021-01-21 4:43PM
MT for full access information.


# Received files

* `{u,v}10m.1958-2019.BN_RACMO2.3p2_FGRN055_5.5km.YY-mean.nc.gz`
* `Icemask_Topo_Iceclasses_lon_lat_average_1km_GrIS.nc.gz`
* `<variable>.1958-2019.BN_RACMO2.3p2_FGRN055_1km.YY-mean.nc.gz`
  * `precip`
  * `refreeze`
  * `runoff`
  * `smb_rec`
  * `sndiv`
  * `snowfall`
  * `snowmelt`
  * `subl`
  * `t2m`


## August 2020

`RACMO_QGreenland_Aug2020.zip` is the original package provided by Brice on Dropbox.

This batch of files contained a `refreeze` file which could not be `gunzip`ed. Error:

```
gzip: refreeze.1958-2018.BN_RACMO2.3p2_FGRN055_1km.YYmean.nc.gz: unexpected end of file
```


## January 2021

Instead of a zip, we downloaded each individual file from the server. See
`fetch.sh`. This contains the fix for the 0-byte `refreeze` file.


# Produced files

The following files are generated by preprocessing scripts run on the received files.

## Raster layers: `extracted_1km.zip`

The `./recompress.sh` script shuffles the 1km netcdf files into a format more
usable with our processing pipeline. It's probably possible to work this step
in to our processing pipeline instead of doing it as a pre-process step. This
was more convenient on a short timeline. Steps taken by `recompress.sh`:

* Extract 1km `.nc.gz` files using `gunzip`
* Re-archive all files as `.zip`


## Calculated wind vectors: `wind_vector_points.gpkg`

The `./racmo_wind_vectors.py` script produces `wind_vector_points.gpkg` to
include points derived from wind direction component magnitudes in the `u10m`
and `v10m` 5.5km component grids. Steps taken in this process:

* Generate `wind_vector_points.csv` from `u10m` and `v10m` input grids.
* Use `ogr2ogr` to convert `.csv` to `.gpkg`:
    ogr2ogr -oo X_POSSIBLE_NAMES=x -oo Y_POSSIBLE_NAMES=y -a_srs "EPSG:3413" -oo AUTODETECT_TYPE=True wind_vector_points.gpkg wind_vector_points.csv
* Clean up `wind_vector_points.csv` temporary file
